---
title: Quick Start
icon: Rocket
---

import { Step, Steps } from "fumadocs-ui/components/steps";
import { Callout } from "fumadocs-ui/components/callout";
import { Tab, Tabs } from "fumadocs-ui/components/tabs";
import { Card, Cards } from "fumadocs-ui/components/card";
import { Accordion, Accordions } from "fumadocs-ui/components/accordion";

You can have file uploads in your web app in a few minutes with Pushduck. This guide will walk you through the steps to set it up with any framework.

Before you start, make sure you have an S3-compatible bucket ready. You can use AWS S3, Cloudflare R2, or any other S3-compatible service.

## Uploading your first image

<Steps>

<Step>

### Install

Install the `pushduck` package.

```npm
npm install pushduck
```

</Step>

<Step>

### Set up server

Your server will create pre-signed URLs, which the client uses to upload files directly to the S3 bucket.

Change `my-bucket` to your bucket name, and configure the S3 client as needed.

```ts tab="Next.js" title="app/api/upload/route.ts"
import { createUploadConfig } from 'pushduck/server';

const { s3, config } = createUploadConfig()
  .provider("aws", {
    bucket: process.env.AWS_BUCKET_NAME!, // [!code highlight]
    region: process.env.AWS_REGION!,
    accessKeyId: process.env.AWS_ACCESS_KEY_ID!,
    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY!,
  })
  .defaults({
    maxFileSize: '10MB',
    acl: 'public-read',
  })
  .build();

const router = s3.createRouter({
  imageUpload: s3.image().maxFileSize('5MB'), // [!code highlight]
});

export const { GET, POST } = router.handlers; // [!code highlight]
```

```ts tab="Remix" title="app/routes/api.upload.ts"
import { ActionFunctionArgs } from '@remix-run/node';
import { createUploadConfig } from 'pushduck/server';

const { s3, config } = createUploadConfig()
  .provider("aws", {
    bucket: process.env.AWS_BUCKET_NAME!, // [!code highlight]
    region: process.env.AWS_REGION!,
    accessKeyId: process.env.AWS_ACCESS_KEY_ID!,
    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY!,
  })
  .defaults({
    maxFileSize: '10MB',
    acl: 'public-read',
  })
  .build();

const router = s3.createRouter({
  imageUpload: s3.image().maxFileSize('5MB'), // [!code highlight]
});

export async function action({ request }: ActionFunctionArgs) {
  return router.handlers(request); // [!code highlight]
}
```

```ts tab="SvelteKit" title="src/routes/api/upload/[...path]/+server.ts"
import type { RequestHandler } from './$types';
import { createUploadConfig } from 'pushduck/server';

const { s3, config } = createUploadConfig()
  .provider("aws", {
    bucket: process.env.AWS_BUCKET_NAME!, // [!code highlight]
    region: process.env.AWS_REGION!,
    accessKeyId: process.env.AWS_ACCESS_KEY_ID!,
    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY!,
  })
  .defaults({
    maxFileSize: '10MB',
    acl: 'public-read',
  })
  .build();

const router = s3.createRouter({
  imageUpload: s3.image().maxFileSize('5MB'), // [!code highlight]
});

export const GET: RequestHandler = async ({ request }) => {
  return router.handlers(request); // [!code highlight]
};

export const POST: RequestHandler = async ({ request }) => {
  return router.handlers(request); // [!code highlight]
};
```

```ts tab="Hono" title="server.ts"
import { Hono } from 'hono';
import { createUploadConfig } from 'pushduck/server';

const { s3, config } = createUploadConfig()
  .provider("aws", {
    bucket: process.env.AWS_BUCKET_NAME!, // [!code highlight]
    region: process.env.AWS_REGION!,
    accessKeyId: process.env.AWS_ACCESS_KEY_ID!,
    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY!,
  })
  .defaults({
    maxFileSize: '10MB',
    acl: 'public-read',
  })
  .build();

const router = s3.createRouter({
  imageUpload: s3.image().maxFileSize('5MB'), // [!code highlight]
});

const app = new Hono();

app.all('/api/upload/*', (c) => {
  return router.handlers(c.req.raw); // [!code highlight]
});

export default app;
```

In the example above, we create the upload route `imageUpload`. Learn more about upload routes [here](/docs/api/s3-router).

<Accordions>
<Accordion title="Adding authentication">

You can run code before uploads in the server. Use the `middleware` callback:

```ts title="Authentication Example"
import { createUploadConfig } from 'pushduck/server';

const { s3, config } = createUploadConfig()
  .provider("aws", {
    bucket: process.env.AWS_BUCKET_NAME!, // [!code highlight]
    region: process.env.AWS_REGION!,
    accessKeyId: process.env.AWS_ACCESS_KEY_ID!,
    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY!,
  })
  .build();

const router = s3.createRouter({
  imageUpload: s3.image()
    .maxFileSize('5MB')
    .middleware(async ({ req, metadata }) => { // [!code highlight]
      // Add your authentication logic here
      const user = await getCurrentUser(req);
      
      if (!user) {
        throw new Error('Authentication required'); // [!code highlight]
      }
      
      return {
        ...metadata,
        userId: user.id,
      };
    }),
});
```

</Accordion>
<Accordion title="Changing S3 object key">

You can change the S3 object key to any value you want. Use the `paths` configuration:

```ts title="Custom S3 Object Keys"
const { s3, config } = createUploadConfig()
  .provider("aws", {
    bucket: process.env.AWS_BUCKET_NAME!, // [!code highlight]
    region: process.env.AWS_REGION!,
    accessKeyId: process.env.AWS_ACCESS_KEY_ID!,
    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY!,
  })
  .paths({
    prefix: 'uploads',
    generateKey: (file, metadata) => { // [!code highlight]
      const userId = metadata.userId || 'anonymous';
      const timestamp = Date.now();
      return `${userId}/${timestamp}/${file.name}`; // [!code highlight]
    },
  })
  .build();
```

</Accordion>
</Accordions>

</Step>

<Step>

### Create upload client

We will now build our UI using the upload client. We'll use `createUploadClient` for type-safe uploads.

```ts title="lib/upload-client.ts"
import { createUploadClient } from 'pushduck/client';
import type { AppRouter } from './upload';

export const upload = createUploadClient<AppRouter>({
  endpoint: '/api/upload' // [!code highlight]
});
```

We'll also use the `useUpload` hook. The complete component looks like this:

```tsx title="components/uploader.tsx"
'use client'; // For Next.js

import { upload } from '@/lib/upload-client';

export function Uploader() {
  const { uploadFiles, files, isUploading, error } = upload.imageUpload(); // [!code highlight]

  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {
    const selectedFiles = Array.from(e.target.files || []);
    uploadFiles(selectedFiles); // [!code highlight]
  };

  return (
    <div>
        <input
          type="file"
          multiple
          accept="image/*"
        onChange={handleFileSelect}
          disabled={isUploading}
      />

      {files.map((file) => (
        <div key={file.id}>
          <span>{file.name}</span>
          <progress value={file.progress} max={100} />
          {file.status === 'success' && file.url && (
            <a href={file.url}>View uploaded file</a> // [!code highlight]
          )}
            </div>
          ))}

      {error && <div>Error: {error.message}</div>}
    </div>
  );
}
```

Learn more about the client hooks [here](/docs/api/client).

</Step>

<Step>

### Place the component

Now place the `<Uploader />` component in your app.

```tsx title="page.tsx"
import { Uploader } from '@/components/uploader';

export default function Page() {
  return (
    <main className="flex min-h-screen flex-col items-center justify-center">
      <Uploader />
    </main>
  );
}
```

</Step>

<Step>

### You're done! ðŸŽ‰

You can now run your app and upload images directly to any S3-compatible service!

If you plan on uploading files larger than **5GB**, take a look at [multipart uploads](/docs/api/s3-router#multipart-uploads).

<Accordions>
<Accordion title="CORS Configuration">

Make sure to also correctly configure CORS on your bucket. Here is an example:

```json
[
  {
    "AllowedOrigins": [
      "http://localhost:3000",
      "https://example.com" // Add your domain here
    ],
    "AllowedMethods": ["GET", "PUT", "POST", "DELETE"],
    "AllowedHeaders": ["*"],
    "ExposeHeaders": ["ETag"]
  }
]
```

Learn more about CORS [here](https://docs.aws.amazon.com/AmazonS3/latest/userguide/ManageCorsUsing.html).

</Accordion>
</Accordions>

</Step>

</Steps>

## Learn more

### Concepts

<Cards>
  <Card
    href="/docs/api/s3-router"
    title="Upload routes"
    description="Configure upload routes for different behaviors."
  />
  <Card
    href="/docs/api/client"
    title="Client hooks"
    description="Use client-side hooks to easily upload files."
  />
</Cards>

### Guides

<Cards>
  <Card
    href="/docs/guides/client-approaches"
    title="Client approaches"
    description="Choose between property-based and hook-based clients."
  />
  <Card
      href="/docs/guides/uploads/images"
    title="Image uploads"
    description="Handle image uploads with validation and optimization."
  />
</Cards>

### Components

<Cards>
  <Card
    href="/docs/api/client/create-upload-client"
    title="Property-based client"
    description="Enhanced type safety with property-based access."
  />
  <Card
    href="/docs/api/client/use-upload-route"
    title="Hook-based client"
    description="Familiar React hooks for upload management."
  />
  <Card
    href="/docs/examples"
    title="Examples"
    description="Complete examples for different use cases."
  />
</Cards>
